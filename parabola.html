<!DOCTYPE html>
<html>
<head>
  <title>Par√°bola Ritualizada</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f0f0f0; }
    input { width: 80px; margin: 5px; }
    canvas { border: 1px solid #000; margin-top: 20px; }
  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>
  <h2>üî∫ Ceremonia de la Par√°bola</h2>
  <p>Ingresa el v√©rtice:</p>
  <label>h (x del v√©rtice): <input type="number" id="h"></label>
  <label>k (y del v√©rtice): <input type="number" id="k"></label>

  <h3>üî¥ Foco (opcional):</h3>
  <label>x: <input type="number" id="fx"></label>
  <label>y: <input type="number" id="fy"></label>

  <h3>üìè O ingresa directamente la distancia focal:</h3>
  <label>p: <input type="number" id="p"></label>

  <br><br>
  <button onclick="resolver()">Calcular y dibujar</button>

  <div id="resultado" style="margin-top:20px;"></div>
  <canvas id="dibujo" width="600" height="400"></canvas>

  <script>
    function resolver() {
      const h = parseFloat(document.getElementById("h").value);
      const k = parseFloat(document.getElementById("k").value);
      const fx = parseFloat(document.getElementById("fx").value);
      const fy = parseFloat(document.getElementById("fy").value);
      let p = parseFloat(document.getElementById("p").value);

      let resultado = "";

      if (isNaN(h) || isNaN(k)) {
        resultado = "<p>‚ö†Ô∏è Debes ingresar el v√©rtice (h, k).</p>";
        document.getElementById("resultado").innerHTML = resultado;
        return;
      }

      let orientacion = "vertical";

      if (!isNaN(fx) && !isNaN(fy)) {
        const dx = fx - h;
        const dy = fy - k;
        if (Math.abs(dy) > Math.abs(dx)) {
          p = dy;
          orientacion = "vertical";
        } else {
          p = dx;
          orientacion = "horizontal";
        }

        resultado += `<h3>üìè C√°lculo de la distancia focal:</h3>`;
        resultado += `<p>\\[ p = \\text{distancia entre v√©rtice y foco} = ${p.toFixed(2)} \\]</p>`;
      }

      if (isNaN(p)) {
        resultado += "<p>‚ö†Ô∏è Debes ingresar la distancia focal o el foco.</p>";
        document.getElementById("resultado").innerHTML = resultado;
        MathJax.typeset();
        return;
      }

      const ladoRecto = 4 * Math.abs(p);

      // Ecuaci√≥n can√≥nica
      resultado += `<h3>üìê Ecuaci√≥n can√≥nica:</h3>`;
      if (orientacion === "vertical") {
        resultado += `<p>\\[ (x - ${h})^2 = 4 \\cdot ${p.toFixed(2)} \\cdot (y - ${k}) \\]</p>`;
      } else {
        resultado += `<p>\\[ (y - ${k})^2 = 4 \\cdot ${p.toFixed(2)} \\cdot (x - ${h}) \\]</p>`;
      }

      // Directriz
      resultado += `<h3>üìè Directriz:</h3>`;
      if (orientacion === "vertical") {
        resultado += `<p>\\[ y = ${k - p} \\]</p>`;
      } else {
        resultado += `<p>\\[ x = ${h - p} \\]</p>`;
      }

      resultado += `<h3>üìè Lado recto:</h3>`;
      resultado += `<p>\\[ L = 4p = 4 \\cdot ${p.toFixed(2)} = ${ladoRecto.toFixed(2)} \\]</p>`;

      document.getElementById("resultado").innerHTML = resultado;
      MathJax.typeset();

      // Dibujo
      const canvas = document.getElementById("dibujo");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const escala = 10;
      const cx = canvas.width / 2;
      const cy = canvas.height / 2;

      const vx = cx + h * escala;
      const vy = cy - k * escala;
      const focoX = orientacion === "vertical" ? vx : vx + p * escala;
      const focoY = orientacion === "vertical" ? vy - p * escala : vy;

      // Par√°bola
      ctx.beginPath();
      ctx.strokeStyle = "blue";
      for (let i = -ladoRecto; i <= ladoRecto; i += 1) {
        let x, y;
        if (orientacion === "vertical") {
          x = vx + i;
          y = vy + (i * i) / (4 * p * escala);
        } else {
          y = vy - i;
          x = vx + (i * i) / (4 * p * escala);
        }
        if (i === -ladoRecto) {
          ctx.moveTo(x, y);
        } else {
          ctx.lineTo(x, y);
        }
      }
      ctx.stroke();

      // V√©rtice
      ctx.beginPath();
      ctx.arc(vx, vy, 4, 0, 2 * Math.PI);
      ctx.fillStyle = "black";
      ctx.fill();
      ctx.fillText(`V√©rtice (${h}, ${k})`, vx + 10, vy - 10);

      // Foco
      ctx.beginPath();
      ctx.arc(focoX, focoY, 4, 0, 2 * Math.PI);
      ctx.fillStyle = "red";
      ctx.fill();
      ctx.fillText(`Foco`, focoX + 10, focoY + 15);

      // Directriz
      ctx.strokeStyle = "green";
      ctx.beginPath();
      if (orientacion === "vertical") {
        const dy = cy - (k - p) * escala;
        ctx.moveTo(0, dy);
        ctx.lineTo(canvas.width, dy);
        ctx.fillText(`Directriz y = ${k - p}`, 10, dy - 5);
      } else {
        const dx = cx + (h - p) * escala;
        ctx.moveTo(dx, 0);
        ctx.lineTo(dx, canvas.height);
        ctx.fillText(`Directriz x = ${h - p}`, dx + 5, 15);
      }
      ctx.stroke();
    }
  </script>
</body>
</html>