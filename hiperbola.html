<!DOCTYPE html>
<html>
<head>
  <title>Hipérbola Ritualizada</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f0f0f0; }
    input { width: 80px; margin: 5px; }
    canvas { border: 1px solid #000; margin-top: 20px; }
  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>
  <h2>🔱 Ceremonia de la Hipérbola</h2>
  <p>Ingresa el centro:</p>
  <label>h (x del centro): <input type="number" id="h"></label>
  <label>k (y del centro): <input type="number" id="k"></label>

  <h3>📏 Semiejes:</h3>
  <label>a (real): <input type="number" id="a"></label>
  <label>b (imaginario): <input type="number" id="b"></label>

  <h3>🔁 Orientación:</h3>
  <label><input type="radio" name="orientacion" value="horizontal" checked> Horizontal</label>
  <label><input type="radio" name="orientacion" value="vertical"> Vertical</label>

  <br><br>
  <button onclick="resolver()">Calcular y dibujar</button>

  <div id="resultado" style="margin-top:20px;"></div>
  <canvas id="dibujo" width="600" height="400"></canvas>

  <script>
    function resolver() {
      const h = parseFloat(document.getElementById("h").value);
      const k = parseFloat(document.getElementById("k").value);
      const a = parseFloat(document.getElementById("a").value);
      const b = parseFloat(document.getElementById("b").value);
      const orientacion = document.querySelector('input[name="orientacion"]:checked').value;

      let resultado = "";

      if (isNaN(h) || isNaN(k) || isNaN(a) || isNaN(b)) {
        resultado = "<p>⚠️ Debes ingresar el centro y los semiejes.</p>";
        document.getElementById("resultado").innerHTML = resultado;
        return;
      }

      const c = Math.sqrt(a * a + b * b);

      // Ecuación canónica
      resultado += `<h3>📐 Ecuación canónica:</h3>`;
      if (orientacion === "horizontal") {
        resultado += `<p>\\[ \\frac{(x - ${h})^2}{${a * a}} - \\frac{(y - ${k})^2}{${b * b}} = 1 \\]</p>`;
      } else {
        resultado += `<p>\\[ \\frac{(y - ${k})^2}{${a * a}} - \\frac{(x - ${h})^2}{${b * b}} = 1 \\]</p>`;
      }

      // Distancia focal
      resultado += `<h3>📏 Distancia focal:</h3>`;
      resultado += `<p>\\[ c = \\sqrt{a^2 + b^2} = \\sqrt{${a}^2 + ${b}^2} = ${c.toFixed(2)} \\]</p>`;

      // Focos
      resultado += `<h3>📍 Focos:</h3>`;
      if (orientacion === "horizontal") {
        resultado += `<p>\\[ F_1 = (${h - c.toFixed(2)}, ${k}) \\quad F_2 = (${h + c.toFixed(2)}, ${k}) \\]</p>`;
      } else {
        resultado += `<p>\\[ F_1 = (${h}, ${k - c.toFixed(2)}) \\quad F_2 = (${h}, ${k + c.toFixed(2)}) \\]</p>`;
      }

      // Asíntotas
      resultado += `<h3>📈 Asíntotas:</h3>`;
      if (orientacion === "horizontal") {
        resultado += `<p>\\[ y = ${k} \\pm \\frac{${b}}{${a}}(x - ${h}) \\]</p>`;
      } else {
        resultado += `<p>\\[ y = ${k} \\pm \\frac{${a}}{${b}}(x - ${h}) \\]</p>`;
      }

      document.getElementById("resultado").innerHTML = resultado;
      MathJax.typeset();

      // Dibujo
      const canvas = document.getElementById("dibujo");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const escala = 10;
      const cx = canvas.width / 2;
      const cy = canvas.height / 2;

      const centroX = cx + h * escala;
      const centroY = cy - k * escala;
      const aPix = a * escala;
      const bPix = b * escala;
      const cPix = c * escala;

      // Hipérbola (dos ramas)
      ctx.beginPath();
      ctx.strokeStyle = "blue";
      for (let i = -aPix * 2; i <= aPix * 2; i += 1) {
        let x, y;
        if (orientacion === "horizontal") {
          x = centroX + i;
          const valor = (i * i) / (aPix * aPix);
          if (valor > 1) {
            y = centroY + bPix * Math.sqrt(valor - 1);
            ctx.lineTo(x, y);
          }
        } else {
          y = centroY - i;
          const valor = (i * i) / (aPix * aPix);
          if (valor > 1) {
            x = centroX + bPix * Math.sqrt(valor - 1);
            ctx.lineTo(x, y);
          }
        }
      }
      ctx.stroke();

      ctx.beginPath();
      ctx.strokeStyle = "blue";
      for (let i = -aPix * 2; i <= aPix * 2; i += 1) {
        let x, y;
        if (orientacion === "horizontal") {
          x = centroX + i;
          const valor = (i * i) / (aPix * aPix);
          if (valor > 1) {
            y = centroY - bPix * Math.sqrt(valor - 1);
            ctx.lineTo(x, y);
          }
        } else {
          y = centroY - i;
          const valor = (i * i) / (aPix * aPix);
          if (valor > 1) {
            x = centroX - bPix * Math.sqrt(valor - 1);
            ctx.lineTo(x, y);
          }
        }
      }
      ctx.stroke();

      // Centro
      ctx.beginPath();
      ctx.arc(centroX, centroY, 4, 0, 2 * Math.PI);
      ctx.fillStyle = "black";
      ctx.fill();
      ctx.fillText(`Centro (${h}, ${k})`, centroX + 10, centroY - 10);

      // Focos
      ctx.fillStyle = "red";
      if (orientacion === "horizontal") {
        ctx.beginPath();
        ctx.arc(centroX - cPix, centroY, 4, 0, 2 * Math.PI);
        ctx.fill();
        ctx.fillText(`F₁`, centroX - cPix - 20, centroY + 15);

        ctx.beginPath();
        ctx.arc(centroX + cPix, centroY, 4, 0, 2 * Math.PI);
        ctx.fill();
        ctx.fillText(`F₂`, centroX + cPix + 10, centroY + 15);
      } else {
        ctx.beginPath();
        ctx.arc(centroX, centroY - cPix, 4, 0, 2 * Math.PI);
        ctx.fill();
        ctx.fillText(`F₁`, centroX + 10, centroY - cPix - 10);

        ctx.beginPath();
        ctx.arc(centroX, centroY + cPix, 4, 0, 2 * Math.PI);
        ctx.fill();
        ctx.fillText(`F₂`, centroX + 10, centroY + cPix + 15);
      }

      // Asíntotas
      ctx.strokeStyle = "gray";
      ctx.setLineDash([5, 5]);
      ctx.beginPath();
      if (orientacion === "horizontal") {
        // y = k ± (b/a)(x - h)
        for (let x = 0; x <= canvas.width; x++) {
          const xReal = (x - cx) / escala;
          const y1 = cy - (k + (b / a) * (xReal - h)) * escala;
          const y2 = cy - (k - (b / a) * (xReal - h)) * escala;
          if (x === 0) {
            ctx.moveTo(x, y1);
          } else {
            ctx.lineTo(x, y1);
          }
        }
        ctx.stroke();

        ctx.beginPath();
        for (let x = 0; x <= canvas.width; x++) {
          const xReal = (x - cx) / escala;
          const y2 = cy - (k - (b / a) * (xReal - h)) * escala;
          if (x === 0) {
            ctx.moveTo(x, y2);
          } else {
            ctx.lineTo(x, y2);
          }
        }
        ctx.stroke();
      } else {
        // y = k ± (a/b)(x - h)
        for (let x = 0; x <= canvas.width; x++) {
          const xReal = (x - cx) / escala;
          const y1 = cy - (k + (a / b) * (xReal - h)) * escala;
          const y2 = cy - (k - (a / b) * (xReal - h)) * escala;
          if (x === 0) {
            ctx.moveTo(x, y1);
          } else {
            ctx.lineTo(x, y1);
          }
        }
        ctx.stroke();

        ctx.beginPath();
        for (let x = 0; x <= canvas.width; x++) {
          const xReal = (x - cx) / escala;
          const y2 = cy - (k - (a / b) * (xReal - h)) * escala;
          if (x === 0) {
            ctx.moveTo(x, y2);
          } else {
            ctx.lineTo(x, y2);
          }
        }
        ctx.stroke();
      }
      ctx.setLineDash([]);
    }
  </script>
</body>
</html>