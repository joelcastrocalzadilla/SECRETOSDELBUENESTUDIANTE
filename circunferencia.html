<!DOCTYPE html>
<html>
<head>
  <title>Circunferencia Ritualizada</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f0f0f0; }
    input { width: 80px; margin: 5px; }
    canvas { border: 1px solid #000; margin-top: 20px; }
  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>
  <h2>🎯 Ceremonia de la Circunferencia</h2>
  <p>Ingresa el centro de la circunferencia:</p>
  <label>h (x del centro): <input type="number" id="h"></label>
  <label>k (y del centro): <input type="number" id="k"></label>

  <h3>📌 Punto sobre la circunferencia (opcional):</h3>
  <label>x: <input type="number" id="px"></label>
  <label>y: <input type="number" id="py"></label>

  <h3>📏 O ingresa directamente el radio:</h3>
  <label>r: <input type="number" id="r"></label>

  <br><br>
  <button onclick="resolver()">Calcular y dibujar</button>

  <div id="resultado" style="margin-top:20px;"></div>
  <canvas id="dibujo" width="500" height="500"></canvas>

  <script>
    function resolver() {
      const h = parseFloat(document.getElementById("h").value);
      const k = parseFloat(document.getElementById("k").value);
      const px = parseFloat(document.getElementById("px").value);
      const py = parseFloat(document.getElementById("py").value);
      let r = parseFloat(document.getElementById("r").value);

      let resultado = "";

      if (isNaN(h) || isNaN(k)) {
        resultado = "<p>⚠️ Debes ingresar el centro (h, k).</p>";
        document.getElementById("resultado").innerHTML = resultado;
        return;
      }

      // Calcular radio si se dio punto
      if (!isNaN(px) && !isNaN(py)) {
        const dx = px - h;
        const dy = py - k;
        r = Math.sqrt(dx * dx + dy * dy);
        resultado += `<h3>📏 Cálculo del radio:</h3>`;
        resultado += `<p>\\[ r = \\sqrt{(x - h)^2 + (y - k)^2} = \\sqrt{(${px} - ${h})^2 + (${py} - ${k})^2} = ${r.toFixed(2)} \\]</p>`;
      }

      if (isNaN(r)) {
        resultado += "<p>⚠️ Debes ingresar el radio o un punto sobre la circunferencia.</p>";
        document.getElementById("resultado").innerHTML = resultado;
        MathJax.typeset();
        return;
      }

      // Ecuación canónica
      resultado += `<h3>📐 Ecuación canónica:</h3>`;
      resultado += `<p>\\[ (x - ${h})^2 + (y - ${k})^2 = ${r.toFixed(2)}^2 = ${Math.pow(r, 2).toFixed(2)} \\]</p>`;

      // Ecuación general
      const D = -2 * h;
      const E = -2 * k;
      const F = h * h + k * k - r * r;
      resultado += `<h3>📐 Ecuación general:</h3>`;
      resultado += `<p>\\[ x^2 + y^2 ${D >= 0 ? "+ " + D : "- " + Math.abs(D)}x ${E >= 0 ? "+ " + E : "- " + Math.abs(E)}y ${F >= 0 ? "+ " + F.toFixed(2) : "- " + Math.abs(F.toFixed(2))} = 0 \\]</p>`;

      document.getElementById("resultado").innerHTML = resultado;
      MathJax.typeset();

      // Dibujo
      const canvas = document.getElementById("dibujo");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const escala = 10;
      const cx = canvas.width / 2;
      const cy = canvas.height / 2;

      const centroX = cx + h * escala;
      const centroY = cy - k * escala;
      const radioPix = r * escala;

      // Circunferencia
      ctx.beginPath();
      ctx.arc(centroX, centroY, radioPix, 0, 2 * Math.PI);
      ctx.strokeStyle = "blue";
      ctx.lineWidth = 2;
      ctx.stroke();

      // Centro
      ctx.beginPath();
      ctx.arc(centroX, centroY, 4, 0, 2 * Math.PI);
      ctx.fillStyle = "black";
      ctx.fill();
      ctx.fillText(`Centro (${h}, ${k})`, centroX + 10, centroY - 10);

      // Punto dado (si existe)
      if (!isNaN(px) && !isNaN(py)) {
        const puntoX = cx + px * escala;
        const puntoY = cy - py * escala;
        ctx.beginPath();
        ctx.arc(puntoX, puntoY, 4, 0, 2 * Math.PI);
        ctx.fillStyle = "red";
        ctx.fill();
        ctx.fillText(`Punto (${px}, ${py})`, puntoX + 10, puntoY - 10);
      }

      // Radio visual
      ctx.beginPath();
      ctx.moveTo(centroX, centroY);
      ctx.lineTo(centroX + radioPix, centroY);
      ctx.strokeStyle = "green";
      ctx.stroke();
      ctx.fillText(`r = ${r.toFixed(2)}`, centroX + radioPix / 2, centroY - 5);
    }
  </script>
  <div style="margin-top: 40px; text-align: center;">
  <button onclick="window.location.href='principal.html'" style="padding: 10px 20px; background-color: #4e342e; color: white; border: none; border-radius: 5px; font-size: 16px;">
    🚪 Salir del sistema
  </button>
</div>

</body>

</html>
