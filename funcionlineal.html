<!DOCTYPE html>
<html>
<head>
  <title>Ceremonia de la Función Lineal</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f9f9f9; }
    input { width: 80px; margin: 5px; }
    table { border-collapse: collapse; margin-top: 10px; }
    th, td { padding: 5px; text-align: center; }
    canvas { border: 1px solid #000; margin-top: 20px; }
  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>
  <h2>📈 Ceremonia de la Función Lineal</h2>
  <p>Ingresa los coeficientes de la función:</p>
  <label>m (pendiente): <input type="number" id="m"></label>
  <label>b (intersección): <input type="number" id="b"></label>
  <br><br>
  <button onclick="calcular()">Calcular y graficar</button>

  <div id="modelo" style="margin-top:20px;"></div>

  <h3>📊 Tabla de valores</h3>
  <table border="1">
    <tr><th>x</th><th>f(x) = mx + b</th></tr>
    <tbody id="tabla"></tbody>
  </table>

  <div id="calculos" style="margin-top:20px;"></div>
  <canvas id="grafico" width="600" height="400"></canvas>

  <script>
    function calcular() {
      const m = parseFloat(document.getElementById("m").value);
      const b = parseFloat(document.getElementById("b").value);
      const xs = [-2, -1, 0, 1, 2];
      const tabla = document.getElementById("tabla");
      const calculos = document.getElementById("calculos");
      const modelo = document.getElementById("modelo");

      if (isNaN(m) || isNaN(b)) {
        modelo.innerHTML = "<p>⚠️ Ingresa valores válidos para m y b.</p>";
        tabla.innerHTML = "";
        calculos.innerHTML = "";
        return;
      }

      // Mostrar modelo
      modelo.innerHTML = `
        <h3>📐 Modelo de la función:</h3>
        \\[ f(x) = ${m}x ${b >= 0 ? "+ " + b : "- " + Math.abs(b)} \\]
        <p>Pendiente: <strong>${m}</strong> &nbsp;&nbsp; Intersección: <strong>${b}</strong></p>
      `;

      tabla.innerHTML = "";
      let contenido = "<h3>📐 Cálculos:</h3>";
      const puntos = [];

      xs.forEach(x => {
        const fx = m * x + b;
        tabla.innerHTML += `<tr><td>${x}</td><td>${fx.toFixed(2)}</td></tr>`;
        contenido += `\\[ f(${x}) = ${m} \\cdot ${x} + ${b} = ${fx.toFixed(2)} \\]<br>`;
        puntos.push({ x, y: fx });
      });

      calculos.innerHTML = contenido;
      MathJax.typeset();

      // Dibujo
      const canvas = document.getElementById("grafico");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Ejes
      const cx = canvas.width / 2;
      const cy = canvas.height / 2;
      ctx.beginPath();
      ctx.moveTo(0, cy);           // eje X
      ctx.lineTo(canvas.width, cy);
      ctx.moveTo(cx, 0);           // eje Y
      ctx.lineTo(cx, canvas.height);
      ctx.strokeStyle = "black";
      ctx.lineWidth = 1;
      ctx.stroke();

      // Etiquetas de los ejes
      ctx.fillStyle = "black";
      ctx.font = "14px Arial";
      ctx.fillText("Eje X", canvas.width - 50, cy - 10);
      ctx.fillText("Eje Y", cx + 10, 20);

      // Escala
      const escala = 40;

      // Línea que une los puntos
      ctx.beginPath();
      puntos.forEach((p, i) => {
        const px = cx + p.x * escala;
        const py = cy - p.y * escala;
        if (i === 0) ctx.moveTo(px, py);
        else ctx.lineTo(px, py);
      });
      ctx.strokeStyle = "blue";
      ctx.lineWidth = 2;
      ctx.stroke();

      // Puntos individuales
      puntos.forEach(p => {
        const px = cx + p.x * escala;
        const py = cy - p.y * escala;
        ctx.beginPath();
        ctx.arc(px, py, 4, 0, 2 * Math.PI);
        ctx.fillStyle = "red";
        ctx.fill();
        ctx.fillText(`(${p.x}, ${p.y.toFixed(2)})`, px + 5, py - 5);
      });
    }
  </script>
  <div style="margin-top: 40px; text-align: center;">
  <button onclick="window.location.href='principal.html'" style="padding: 10px 20px; background-color: #4e342e; color: white; border: none; border-radius: 5px; font-size: 16px;">
    🚪 Salir del sistema
  </button>
</div>

</body>

</html>
